Overview
===========

This is part of a research project to construct a formally verified compiler
for Lustre. This work is described in the research paper 'A Verified
Transformation to Unify Nested Clocks in a Lustre-like Language' (currently
unpublished).


## Files

* We have put some generated results in the archive for convenience:
  * The generated HTML documents by 'coqdoc' are put in the 'doc' folder.
    In these HTMLs, Ltac proofs have been stripped for clarity.

  * Transformation results of several examples as generated by 'make test'
    are put in the text file 'results.txt'.

* Coq proof scripts reside in the 'src' folder of the archive.

  * SingleNode.v          The syntax and semantics of the SL language, the
                          well-formedness property, and the soundness of the
                          semantics.

  * Decidable.v           The decidability proof of the well-formedness property.

  * ClockUnify.v          The specification of the clock-unifying transformation,
                          and the expected semantics preserving property.

  * ClockUnifyProof.v     A proof that any translation that confirms to the
                          specification would preserve the semantics.

  * ClockUnifyImpl.v      Gives a translation function that confirms to the
                          specification.

  * Common.v              Common utilities for such as [list] and finite maps.

  * Examples.v            Definition of several sample input programs.

  * Printer.ml            A driver that prints the source and transforming
                          result of examples. (not a proof script)

* The 'apply-once' Ltac plugin is included in the 'apply-once' folder. This
  is required to compile our proof scripts.


## Compiling Prerequisites

We require Coq 8.4pl2, and other versions are not tested.

The 'apply-once' Ltac plugin by Thomas Braibant must be installed. It is
available from https://github.com/braibant/apply-once.

To install it, we did this on our machine:

    cd apply-once
    make    # It seems safe to interrupt when it is printing a lot of new lines
    make -f Makefile.coq install  # Installs the plugin into where Coq resides

## Compiling

    make

Compile the proof scripts (checking the proofs), extract the examples
(along with others) into OCaml, and generate the documents in the 'src/doc'
folder.

    make test

Compile and run the OCaml program to see the transformation results. The
examples are checked by the static checker before fed into the
transformation function. The static checker is extracted from the
decidability proof of the well-formedness property.

    make chk

Run the 'coqchk' utility to double check the generated proofs terms. It
will be slow since it will check every depended standard library module.
'coqchk' will not load any Coq plugins including 'apply-once'.

'coqchk' will report some axioms. Some of them are for extracting. Others
are imported implicitly by 'Require Import Program', and we do not actually
depend on them as shown by 'Print Assumptions'.

    make clean

Clean up the directory
